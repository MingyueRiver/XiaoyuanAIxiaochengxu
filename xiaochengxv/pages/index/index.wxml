<view class="container">
  <!-- é¡¶éƒ¨çŠ¶æ€æ ï¼ˆåŸæœ‰ï¼Œä¸å˜ï¼‰ -->
  <view class="status-bar">
    <view class="location" bindtap="updateLocation">
      <text class="location-text">ğŸ“ {{currentLocation || 'å®šä½ä¸­...'}}</text>
    </view>
    <view class="user-info" wx:if="{{userInfo}}" bindtap="goToProfile">
      <text class="user-name">ğŸ‘¤ ä½ å¥½ï¼Œ{{userInfo.userName}}</text>
    </view>
    <view class="user-info" wx:else bindtap="goToLogin">
      <text class="user-name">ğŸ‘¤ ç‚¹å‡»ç™»å½•</text>
    </view>
  </view>

  <!-- æœç´¢æ¡†ï¼ˆåŸæœ‰ï¼Œä¸å˜ï¼‰ -->
  <view class="search-section">
    <view class="search-box" bindtap="goToSearch">
      <text class="search-text">ğŸ” æœç´¢åœºåœ°ã€ä»»åŠ¡ã€èµ„æº...</text>
    </view>
  </view>

  <!-- æ–°å¢ï¼šä¼˜è´¨èµ„æºæ–‡ç« æ¨èåŒºåŸŸï¼ˆæœç´¢æ¡†ä¸‹æ–¹ï¼ŒAIæ¨èä¸Šæ–¹ï¼‰ -->
  <view class="high-quality-section">
    <!-- æ ç›®æ ‡é¢˜ -->
    <view class="hq-header">
      <text class="hq-title">ä¼˜è´¨èµ„æº</text>
      <view class="hq-more" bindtap="goToResourceCenter">
        <text class="more-text">æŸ¥çœ‹æ›´å¤š</text>
        <text class="more-icon">â†’</text>
      </view>
    </view>

    <!-- æ–‡ç« æ¨èå¡ç‰‡ï¼ˆ1-2ç¯‡ï¼Œæ¨ªå‘æ»šåŠ¨ï¼‰ -->
    <scroll-view scroll-x class="hq-article-scroll" enable-flex>
      <view class="hq-article-card" wx:for="{{highQualityArticles}}" wx:key="id" bindtap="goToArticleDetail" data-id="{{item.id}}">
        <!-- æ–‡ç« å°é¢ -->
        <view class="hq-article-cover">
          <image src="{{item.coverUrl || '/images/article-default.png'}}" mode="aspectFill"></image>
        </view>
        <!-- æ–‡ç« ä¿¡æ¯ -->
        <view class="hq-article-info">
          <text class="hq-article-title">{{item.title}}</text>
          <text class="hq-article-desc">{{item.desc}}</text>
          <view class="hq-article-meta">
            <text class="hq-author">ğŸ‘¤ {{item.author}}</text>
            <text class="hq-views">ğŸ‘ï¸ {{item.views}}æ¬¡</text>
          </view>
        </view>
      </view>
    </scroll-view>
  </view>

  <!-- AIæ¨èåŒºåŸŸï¼ˆåŸæœ‰ï¼Œä¸å˜ï¼‰ -->
  <view class="recommendation-section">
    <view class="section-header">
      <text class="section-title">æ™ºèƒ½æ¨è</text>
      <text class="section-desc">ä¸ºæ‚¨ç²¾å¿ƒæŒ‘é€‰çš„å†…å®¹</text>
    </view>

    <!-- æ¨èæ ‡ç­¾ -->
    <view class="recommend-tags">
      <view class="tag {{activeTag === 'all' ? 'active' : ''}}" bindtap="switchTag" data-tag="all">å…¨éƒ¨</view>
      <view class="tag {{activeTag === 'venues' ? 'active' : ''}}" bindtap="switchTag" data-tag="venues">åœºåœ°</view>
      <view class="tag {{activeTag === 'tasks' ? 'active' : ''}}" bindtap="switchTag" data-tag="tasks">ä»»åŠ¡</view>
      <view class="tag {{activeTag === 'resources' ? 'active' : ''}}" bindtap="switchTag" data-tag="resources">èµ„æº</view>
    </view>

    <!-- æ¨èå†…å®¹ -->
    <view class="recommend-content">
      <!-- åœºåœ°æ¨è -->
      <view class="recommend-card" wx:if="{{activeTag === 'all' || activeTag === 'venues'}}">
        <view class="card-header">
          <text class="card-title">ğŸ¢ æ¨èåœºåœ°</text>
          <text class="card-more" bindtap="goToVenueList">æ›´å¤š</text>
        </view>
        <view class="card-content">
          <view class="venue-item" wx:for="{{aiRecommendations.venues}}" wx:key="_id" bindtap="viewVenueDetail" data-id="{{item._id}}">
            <view class="venue-image">ğŸ›ï¸</view>
            <view class="venue-info">
              <text class="venue-name">{{item.name}}</text>
              <text class="venue-location">ğŸ“ {{item.location}}</text>
              <view class="venue-tags">
                <text class="venue-tag" wx:for="{{item.tags}}" wx:key="*this">{{item}}</text>
              </view>
              <view class="venue-stats">
                <text class="venue-rating">â­ {{item.stats.rating}}</text>
                <text class="venue-match {{item.matchLevel}}">åŒ¹é…åº¦: {{item.matchScore}}%</text>
              </view>
            </view>
          </view>
        </view>
      </view>

      <!-- ä»»åŠ¡æ¨è -->
      <view class="recommend-card" wx:if="{{activeTag === 'all' || activeTag === 'tasks'}}">
        <view class="card-header">
          <text class="card-title">ğŸ“‹ æ¨èä»»åŠ¡</text>
          <text class="card-more" bindtap="goToTaskList">æ›´å¤š</text>
        </view>
        <view class="card-content">
          <view class="task-item" wx:for="{{aiRecommendations.tasks}}" wx:key="_id" bindtap="viewTaskDetail" data-id="{{item._id}}">
            <view class="task-main">
              <text class="task-title">{{item.title}}</text>
              <text class="task-desc">{{item.description}}</text>
              <view class="task-meta">
                <text class="task-reward">ğŸ’° ï¿¥{{item.reward}}</text>
                <text class="task-location">ğŸ“ {{item.location}}</text>
                <text class="task-time">â° {{item.timeLeft}}</text>
              </view>
            </view>
            <view class="task-side">
              <text class="task-urgency {{item.urgency}}">{{item.urgencyText}}</text>
            </view>
          </view>
        </view>
      </view>

      <!-- èµ„æºæ¨è -->
      <view class="recommend-card" wx:if="{{activeTag === 'all' || activeTag === 'resources'}}">
        <view class="card-header">
          <text class="card-title">ğŸ“š æ¨èèµ„æº</text>
          <text class="card-more" bindtap="goToResourceList">æ›´å¤š</text>
        </view>
        <view class="card-content">
          <view class="resource-grid">
            <view class="resource-item" wx:for="{{aiRecommendations.resources}}" wx:key="_id" bindtap="viewResourceDetail" data-id="{{item._id}}">
              <view class="resource-cover">ğŸ“–</view>
              <view class="resource-info">
                <text class="resource-title">{{item.title}}</text>
                <text class="resource-type">{{item.type}}</text>
                <text class="resource-price {{item.isFree ? 'free' : 'paid'}}">
                  {{item.isFree ? 'ğŸ†“ å…è´¹' : 'ğŸ’° ï¿¥' + item.price}}
                </text>
              </view>
            </view>
          </view>
        </view>
      </view>
    </view>
  </view>

  <!-- å¿«æ·æ“ä½œï¼ˆåŸæœ‰ï¼Œä¸å˜ï¼‰ -->
  <view class="quick-actions">
    <view class="action-item" bindtap="postTask">
      <text class="action-icon">ğŸ“</text>
      <text>å‘å¸ƒä»»åŠ¡</text>
    </view>
    <view class="action-item" bindtap="bookVenue">
      <text class="action-icon">ğŸ¢</text>
      <text>é¢„çº¦åœºåœ°</text>
    </view>
    <view class="action-item" bindtap="uploadResource">
      <text class="action-icon">ğŸ“š</text>
      <text>åˆ†äº«èµ„æº</text>
    </view>
  </view>

  <!-- åŠ è½½çŠ¶æ€ï¼ˆåŸæœ‰ï¼Œä¸å˜ï¼‰ -->
  <view wx:if="{{isLoading}}" class="loading">
    <text>â³ åŠ è½½ä¸­...</text>
  </view>

  <!-- ç©ºçŠ¶æ€ï¼ˆåŸæœ‰ï¼Œä¸å˜ï¼‰ -->
  <view wx:if="{{!isLoading && !hasData}}" class="empty-state">
    <text class="empty-icon">ğŸ˜´</text>
    <text class="empty-text">æš‚æ— æ¨èå†…å®¹</text>
    <text class="empty-desc">ç™»å½•åè·å–ä¸ªæ€§åŒ–æ¨è</text>
    <button class="empty-action" bindtap="goToLogin">ç«‹å³ç™»å½•</button>
  </view>
</view>