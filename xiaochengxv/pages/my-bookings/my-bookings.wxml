<view class="container">
  <!-- æ ‡ç­¾åˆ‡æ¢ -->
  <view class="tab-bar">
    <view class="tab-item {{activeTab === 'upcoming' ? 'active' : ''}}" bindtap="switchTab" data-tab="upcoming">
      <text>å³å°†å¼€å§‹</text>
    </view>
    <view class="tab-item {{activeTab === 'past' ? 'active' : ''}}" bindtap="switchTab" data-tab="past">
      <text>å†å²è®°å½•</text>
    </view>
  </view>

  <!-- åŠ è½½çŠ¶æ€ -->
  <view wx:if="{{isLoading}}" class="loading-container">
    <view class="loading-spinner"></view>
    <text class="loading-text">åŠ è½½ä¸­...</text>
  </view>

  <!-- ç©ºçŠ¶æ€ -->
  <view wx:elif="{{isEmpty}}" class="empty-container">
    <text class="empty-icon">ğŸ“…</text>
    <text class="empty-title">è¿˜æ²¡æœ‰é¢„çº¦</text>
    <text class="empty-desc">é¢„çº¦æ ¡å›­åœºåœ°ï¼Œå‚åŠ å„ç§å­¦ä¹ å’Œæ´»åŠ¨</text>
    <button class="book-btn" bindtap="bookNewVenue">ç«‹å³é¢„çº¦åœºåœ°</button>
  </view>

  <!-- é¢„çº¦åˆ—è¡¨ -->
  <view wx:else class="bookings-list">
    <view class="booking-card" wx:for="{{filteredBookings}}" wx:key="_id">
      <!-- é¢„çº¦å¤´éƒ¨ -->
      <view class="booking-header">
        <image src="{{item.venueImage || '/images/venue-default.png'}}" class="venue-image" mode="aspectFill"></image>
        <view class="booking-title-section">
          <text class="venue-name">{{item.venueName}}</text>
          <text class="venue-location">ğŸ“ {{item.location}}</text>
          <view class="status-section">
            <text class="status-badge {{item.status === 'å·²ç¡®è®¤' ? 'confirmed' : item.status === 'å·²å®Œæˆ' ? 'completed' : item.status === 'å·²å–æ¶ˆ' ? 'cancelled' : 'pending'}}">{{item.status}}</text>
            <text class="booking-price">Â¥{{item.price}}</text>
          </view>
        </view>
      </view>

      <!-- é¢„çº¦è¯¦æƒ… -->
      <view class="booking-details">
        <view class="detail-row">
          <text class="detail-label">ğŸ“… æ—¥æœŸï¼š</text>
          <text class="detail-value">{{item.date}}</text>
        </view>
        <view class="detail-row">
          <text class="detail-label">â° æ—¶é—´ï¼š</text>
          <text class="detail-value">{{item.startTime}} - {{item.endTime}} ({{item.duration}})</text>
        </view>
        <view class="detail-row">
          <text class="detail-label">ğŸ‘¥ å®¹é‡ï¼š</text>
          <text class="detail-value">{{item.capacity}} äºº</text>
        </view>
      </view>

      <!-- é¢„çº¦ä¿¡æ¯ -->
      <view class="booking-info">
        <text class="booking-date">é¢„çº¦äº {{item.bookingDate}}</text>
        <text wx:if="{{item.status === 'å·²å–æ¶ˆ' && item.cancelReason}}" class="cancel-reason">å–æ¶ˆåŸå› : {{item.cancelReason}}</text>
      </view>

      <!-- æ“ä½œæŒ‰é’® -->
      <view class="booking-actions">
        <button class="action-btn detail-btn" bindtap="goToBookingDetail" data-id="{{item._id}}">è¯¦æƒ…</button>
        <button wx:if="{{item.status !== 'å·²å®Œæˆ' && item.status !== 'å·²å–æ¶ˆ'}}" class="action-btn edit-btn" bindtap="editBooking" data-id="{{item._id}}">ä¿®æ”¹</button>
        <button wx:if="{{item.status !== 'å·²å®Œæˆ' && item.status !== 'å·²å–æ¶ˆ'}}" class="action-btn cancel-btn" bindtap="cancelBooking" data-id="{{item._id}}">å–æ¶ˆ</button>
        <button wx:if="{{item.status === 'å·²ç¡®è®¤' || item.status === 'å¾…ç¡®è®¤'}}" class="action-btn contact-btn" bindtap="contactVenue" data-venue="{{item.venueName}}">è”ç³»ç®¡ç†å‘˜</button>
      </view>
    </view>
  </view>

  <!-- é¢„çº¦æ–°åœºåœ°æµ®åŠ¨æŒ‰é’® -->
  <view wx:if="{{!isEmpty && !isLoading}}" class="fab-container">
    <button class="fab-button" bindtap="bookNewVenue">+</button>
  </view>
</view>
